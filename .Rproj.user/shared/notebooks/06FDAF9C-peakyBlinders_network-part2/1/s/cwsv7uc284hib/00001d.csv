"0","# ---- WITH ALL NODES ----"
"0","# Calculate all shortest paths in the network"
"0","distances <- distances(peaky_network, weights = NA)"
"0","shortest_distances <- distances[upper.tri(distances)]"
"0",""
"0","# Calculate the average shortest path length"
"0","average_path_length <- mean_distance(peaky_network, unconnected = FALSE, weights = NA)"
"0",""
"0","# Create a data frame of the original shortest path distances"
"0","hist_data <- data.frame("
"0","  PathLengths = shortest_distances,"
"0","  Network = ""Original"")"
"0",""
"0","# ---- REMOVING THOMAS ----"
"0","peaky_network_modified <- delete_vertices(peaky_network, c(""thomas""))"
"0","distances_modified <- distances(peaky_network_modified, weights = NA)"
"0","shortest_distances_modified <- distances_modified[upper.tri(distances_modified)]"
"0",""
"0","# Recalculate the average shortest path length in the modified network"
"0","average_path_length_modified <- mean_distance(peaky_network_modified, unconnected = TRUE, weights = NA)"
"0",""
"0","hist_data_modified <- data.frame("
"0","  PathLengths = shortest_distances_modified,"
"0","  Network = ""Without Thomas"") |> "
"0","  filter(is.finite(PathLengths))"
"0",""
"0","# Combine the data frames for original and modified networks"
"0","combined_hist_data <- rbind(hist_data, hist_data_modified)"
"0",""
"0","# Plotting histograms side by side"
"0","distances_hist <- ggplot(combined_hist_data, aes(x = PathLengths, fill = Network)) +"
"0","  geom_bar(color = ""black"", position = ""dodge"") +"
"0","  scale_x_continuous(breaks = seq(0, 4, by = 1)) +"
"0","  labs(x = ""Shortest Path Length"", y = ""Frequency"") +"
"0","  theme_minimal() +"
"0","  theme(panel.grid.major.x = element_blank(),"
"0","        panel.grid.minor.x = element_blank(),"
"0","        legend.position = ""None"")+"
"0","  annotate(""text"","
"0","           x = 3.6, y = 1073,"
"0","           label = paste0(""Average Path Length: "", round(average_path_length, 2)),"
"0","           fontface = ""bold"","
"0","           col = ""#f7766d"","
"0","           size = 7) +"
"0","  annotate(""text"","
"0","           x = 2.975, y = 883,"
"0","           label = paste0(""Average Path Length: "", round(average_path_length_modified, 2),""\n(after removing Thomas)""),"
"0","           fontface = ""bold"","
"0","           col = ""#02bfc4"","
"0","           hjust = 0,"
"0","           size = 7)"
"0",""
"0","distances_hist"
